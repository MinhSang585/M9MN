function getWalletEB(elem){$.ajax({type:'POST',url:'a/getWallet',dataType:'json'}).success(function(data){if(data.status=='0'){drawBalanceTable(data.d,elem);}});}
function drawBalanceTable(data,elem){var txtnode='';var walletLbl='';var prefix='';var keysSorted=Object.keys(data).sort(function(a,b){return data[a].seq-data[b].seq});if(elem=='curballist'){txtnode='<ul><li class="summary_header"><div class="summary_left">'+walletSummary+'</div><div class="summary_right">'+balanceCap+'</div><div style="clear:both"></div></li>';prefix='cur';$.each(keysSorted,function(a,index){var d=data[index];var font_style='';var rowheight_style='';if(index.toLowerCase()!='ezugi'&&index.toLowerCase()!='hg'){walletLbl=product_cap[index.toLowerCase()]!==undefined?product_cap[index.toLowerCase()]:index.toUpperCase();if(walletLbl.length>30)font_style='style="font-size:13px;"';if(walletLbl.length>30)rowheight_style='style="height:45px;"';txtnode+='<li><div class="summary_wallet"><input type="hidden" name="w_bal_'+prefix+index+'" id="w_bal_'+prefix+index+'" value="0"><span '+font_style+'>'+walletLbl+'</span></div><div id="wallet_'+prefix+index+'" class="summary_amount"><span><img src="'+imgPath+'images/loading.gif" style="text-align: center;width:10px;height:10px;"></span></div><div style="clear:both"></div></li>';}});txtnode+='<li class="summary_foot"><div class="summary_left"><input type="hidden" name="w_bal_'+prefix+'total" id="w_bal_'+prefix+'total" value="0"><span>'+totalLbl+'</span></div><div id="wallet_'+prefix+'total" class="summary_right"><span><img src="'+imgPath+'images/loading.gif" style="text-align: center;width:10px;height:10px;"></span></div><div style="clear:both"></div></li>';txtnode+='</ul>';document.getElementById(elem).innerHTML=txtnode;}else{prefix='';$.each(keysSorted,function(a,index){var d=data[index];if(index.toLowerCase()=='internal'){walletLbl=subWalletATxt+'<div class="expend-internal-wallet">+</div><div class="expend-internal-content">';walletLbl+='<ul>';$.each(product_cap[index.toLowerCase()],function(i,v){walletLbl+='<li>'+v+'</li>';});walletLbl+='</ul></div>';}else{walletLbl=product_cap[index.toLowerCase()]!==undefined?product_cap[index.toLowerCase()]:index.toUpperCase();}
if(index.toLowerCase()=='main'){txtnode+='<div class="wallet-head"><p><input type="hidden" name="w_bal_'+prefix+index+'" id="w_bal_'+prefix+index+'" value="0">'+mainBalanceTxt+'</p><p id="wallet_'+prefix+index+'"><span id="wallet_loading_'+prefix+index+'"><img src="'+imgPath+'images/loading.gif" style="text-align: center;width:20px;height:20px;"></span></p></div><table>';}else if(index.toLowerCase()!='ezugi'&&index.toLowerCase()!='hg'){txtnode+='<tr class="wallet-col" id="wallet_'+prefix+index+'">';txtnode+='	<td>';txtnode+='		<p><input type="hidden" name="w_bal_'+prefix+index+'" id="w_bal_'+prefix+index+'" value="0">'+walletLbl+'</p>';txtnode+='	</td>';txtnode+='	<td colspan="3" id="wallet_loading_'+prefix+index+'">';txtnode+='		<p><span><img src="'+imgPath+'images/loading.gif" style="text-align: center;width:20px;height:20px;"></span></p>';txtnode+='	</td>';txtnode+='</tr>';}});txtnode+='</table><div class="wallet-line"></div>';txtnode+='<div class="wallet-total-col"><p><input type="hidden" name="w_bal_'+prefix+'total" id="w_bal_'+prefix+'total" value="0">'+totalLbl+'</p><p id="wallet_'+prefix+'total"><span><img src="'+imgPath+'images/loading.gif" style="text-align: center;width:20px;height:20px;"></span></p></div>';txtnode+='<div class="wallet-btn-wrap"><a href="javascript:void(0);" onclick="newstartTransferAllProcess(\'getWalletEB\');" class="wallet-btn">'+transfer_all_cap+'</a></div>';document.getElementById('div-wallet-balance').innerHTML=txtnode;$('.expend-internal-wallet').click(function(){if($(".expend-internal-content").is(":visible")){$(".expend-internal-content").hide();$(".expend-internal-wallet").html('+');}else{$(".expend-internal-content").show();$(".expend-internal-wallet").html('-');}});}
if(elem=='curballist'){$('#'+elem).parent('ul').toggle();}
$.each(data,function(index,d){if(index.toLowerCase()!='ezugi'&&index.toLowerCase()!='hg')
getWalletBalanceEB(index,prefix,data,elem);});}
function getWalletBalanceEB(wallet,prefix,walletData,elem){$.ajax({type:'POST',url:'a/getGameCCL',data:{wallet:wallet},dataType:'json'}).success(function(data){var bal=data.d.ccl==null?'0':data.d.ccl;if(elem=='curballist'){if(bal!='-9999'){var cur_top='<span class="cur">'+currencyLbl+' </span>';var curCCL=parseFloat(bal);$("#w_bal_"+prefix+wallet).val(curCCL);var str='<span id="text_'+prefix+wallet+'">'+cur_top+$.formatNumber(curCCL,{format:"#,##0.00",locale:"us"})+'</span>';if(wallet!='main'&&wallet!='scr888'&&prefix==''){str+='<div id="transferout_'+wallet+'" style="float:right;cursor:pointer;"><img src="'+imgPath+'images/out.png" height="16px" width="16px" title="'+transfer_out.replace("{game}",walletData[wallet].t)+'"></div>';str+='<div id="transferin_'+wallet+'" style="float:right;cursor:pointer;"><img src="'+imgPath+'images/in.png" height="16px" width="16px" title="'+transfer_in.replace("{game}",walletData[wallet].t)+'"></div>';}
$("#wallet_"+prefix+wallet).html(str);if(wallet!='main'){var obj=new Object();obj[wallet]=walletData[wallet];$('#transferin_'+wallet).click(function(){newdrawTransferTable(obj,'getWalletEB','in',wallet);});$('#transferout_'+wallet).click(function(){newdrawTransferTable(obj,'getWalletEB','out',wallet);});}}else{var str='<span id="text_'+wallet+'" >'+underMain+'</span>';$("#wallet_"+prefix+wallet).html(str);}}else{if(bal!='-9999'){var cur_top='<span class="cur">'+currencyLbl+' </span>';var curCCL=parseFloat(bal);$("#w_bal_"+prefix+wallet).val(curCCL);if(wallet=='main'){var str='<div id="text_'+prefix+wallet+'">'+cur_top+$.formatNumber(curCCL,{format:"#,##0.00",locale:"us"})+'</div>';}else{var str='<td id="text_'+prefix+wallet+'">'+$.formatNumber(curCCL,{format:"#,##0.00",locale:"us"})+'</td>';}
if(wallet!='main'&&wallet!='scr888'&&prefix==''){str+='<td id="transferout_'+wallet+'" class="wallet_trans_all_btn"><img src="'+imgPath+'images/'+_m+'/'+lang+'/out.png" title="'+transfer_out.replace("{game}",walletData[wallet].t)+'"></td>';str+='<td id="transferin_'+wallet+'" class="wallet_trans_all_btn"><img src="'+imgPath+'images/'+_m+'/'+lang+'/in.png" title="'+transfer_in.replace("{game}",walletData[wallet].t)+'"></td>';}
$('#wallet_loading_'+prefix+wallet).remove();$("#wallet_"+prefix+wallet).append(str);if(wallet!='main'){var obj=new Object();obj[wallet]=walletData[wallet];$('#transferin_'+wallet).click(function(){newdrawTransferTable(obj,'getWalletEB','in',wallet);});$('#transferout_'+wallet).click(function(){newdrawTransferTable(obj,'getWalletEB','out',wallet);});}}else{$('#wallet_loading_'+prefix+wallet).remove();var str='<td id="text_'+wallet+'" colspan="3">'+underMain+'</td>';$("#wallet_"+prefix+wallet).append(str);}}
sumBalance(wallet,prefix);});}
function sumBalance(wallet,prefix){var ccl=0;$("input[name^='w_bal_"+prefix+"']").each(function(i){if($(this).val()!='-9999')
ccl=ccl+parseFloat($(this).val());});var s=ccl.toString();s=s.replace(",","");var n=parseFloat(s).toFixed(2);$("#wallet_"+prefix+"total").html('<span id="text_'+prefix+'total" style="float:right;"><span class="cur">'+currencyLbl+'</span> '+$.formatNumber(n,{format:"#,##0.00",locale:"us"})+'</span>');}